<div class="container">
  <div class="d-flex justify-content-center">
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card login-form">
        <div class="card-header">
          <h5 class="card-title pl-2">{{if twoFactorRequired (t 'template.login.authcode') (t 'tag.button.signin')}}</h5>
        </div>
        <form {{on "submit" this.authenticate}} method="post">
          <div class="card-body p-4">
            {{#if errorMessage}}
              <div class="alert alert-danger" role="alert" data-test-error>
                {{this.errorMessage}}
              </div>
            {{/if}}

            {{#if (eq loginStage 'credentials')}}
              <div class="form-group">
                <Input @type="text" @value={{username}} placeholder={{t "template.login.username"}} @autofocus="autofocus" @autocorrect="off" @autocapitalize="none" class="form-control" @id="field-username" />
              </div>
              <div class="form-group password-textfield">
                <Input @type="password" @value={{password}} placeholder={{t "template.login.password"}} class="form-control" @id="field-password" />
              </div>

              <div class="row password-forgot-holder">
                <LinkTo @route="users.forgot_password" class="forgot-password-label">{{t 'template.login.forgotPassword'}}</LinkTo>
              </div>
            {{else if (eq loginStage 'WebAuthn')}}
              <div class="form-group">
                <p>
                  {{t 'template.login.securityKeyHint'}}
                </p>

                {{#if this.otpAvailable}}
                  <small {{on "click" (fn this.changeStage 'otp')}}></small>
                {{/if}}
              </div>
            {{else if (eq loginStage 'otp')}}
              <div class="form-group">
                <Input @type="text" @value={{otpCode}} placeholder={{t "template.login.authcode"}} @autocorrect="off" @autocapitalize="none" class="form-control" @id="field-otp" />
                <p>{{t 'template.login.authcodeHint'}}</p>
              </div>
            {{/if}}

            <button type="submit" class="btn btn-primary login-button" id="button-login">{{if twoFactorRequired (t 'tag.button.authenticate') (t 'tag.button.signin')}}</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
